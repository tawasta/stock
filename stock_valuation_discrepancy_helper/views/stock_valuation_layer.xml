<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="stock_valuation_layer_form" model="ir.ui.view">
        <field name="name">stock.valuation.layer.form.helper</field>
        <field name="model">stock.valuation.layer</field>
        <field name="inherit_id" ref="stock_account.stock_valuation_layer_form" />
        <field name="arch" type="xml">
            <field name="remaining_qty" position="after">
                <field name="remaining_qty_discrepancy" />
            </field>
            <field name="quantity" position="after">
                <field name="cumulative_quantity" />
            </field>
        </field>
    </record>

    <record id="stock_valuation_layer_tree" model="ir.ui.view">
        <field name="name">stock.valuation.layer.tree.helper</field>
        <field name="model">stock.valuation.layer</field>
        <field name="inherit_id" ref="stock_account.stock_valuation_layer_tree" />
        <field name="arch" type="xml">
            <field name="quantity" position="after">
                <field
                    name="cumulative_quantity"
                    optional="hide"
                    groups="base.group_no_one"
                />
                <field
                    name="remaining_qty"
                    optional="hide"
                    groups="base.group_no_one"
                />
                <field
                    name="product_on_hand"
                    optional="hide"
                    groups="base.group_no_one"
                />
                <field
                    name="remaining_value"
                    optional="hide"
                    groups="base.group_no_one"
                />
                <field name="remaining_qty_discrepancy" optional="hide" />
                <button
                    name="action_sync_remaining_qty"
                    groups="base.group_no_one"
                    string="Sync remaining"
                    help="Set quantity as the remaining quantity"
                    type="object"
                    icon="fa-refresh text-success"
                    attrs="{'invisible': [('remaining_qty_discrepancy', '=', False)]}"
                />
                <button
                    name="action_clear_remaining_qty"
                    groups="base.group_no_one"
                    string="Clear remaining"
                    help="Remove all remaining quantities"
                    type="object"
                    icon="fa-eraser text-success"
                    attrs="{'invisible': [('remaining_qty', '=', 0)]}"
                />
                <field name="unit_cost" optional="hide" groups="base.group_no_one" />
                <field
                    name="unit_cost_discrepancy"
                    optional="hide"
                    groups="base.group_no_one"
                />
            </field>
            <xpath expr="//button[@name='action_revaluation']" position="after">
                    <button
                        name="action_sync_with_on_hand"
                        groups="base.group_no_one"
                        string="Sync on-hand"
                        help="Sync value with on-hand value"
                        type="object"
                        icon="fa-warning text-warning"
                    />
            </xpath>

        </field>
    </record>

    <record id="view_inventory_valuation_search" model="ir.ui.view">
        <field name="name">stock.valuation.layer.search.helper</field>
        <field name="model">stock.valuation.layer</field>
        <field name="inherit_id" ref="stock_account.view_inventory_valuation_search" />
        <field name="arch" type="xml">
            <field name="product_tmpl_id" position="after">
                <filter
                    string="Quantity discrepancy"
                    name="remaining_qty_discrepancy"
                    domain="[('remaining_qty_discrepancy', '=', True)]"
                />
                <separator />
            </field>
        </field>
    </record>
</odoo>
