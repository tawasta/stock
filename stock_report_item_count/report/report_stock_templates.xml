<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!-- DELIVERY SLIP / DELIVERY DOCUMENT / PACKING LIST -->
    <template
        id="report_delivery_document_item_count"
        inherit_id="stock.report_delivery_document"
        priority="10"
    >
        <xpath expr="//th[@name='th_sb_product']" position="before">
            <th name="th_sb_item_count">
                <strong>Item</strong>
            </th>
        </xpath>
        <xpath expr="//tr[@t-as='bo_line']" position="before">
            <t t-set="current_item" t-value="0" />
        </xpath>
        <xpath expr="//span[@t-field='bo_line.product_id']//.." position="before">
            <td name="td_sb_item_count">
                <t t-set="current_item" t-value="current_item + 1" />
                <span t-esc="current_item" />
            </td>
        </xpath>
        <xpath expr="//th[@name='th_sm_product']" position="before">
            <th name="th_sm_item_count">
                <strong>Item</strong>
            </th>
        </xpath>
        <xpath expr="//tr[@t-as='move']" position="before">
            <t t-set="current_item" t-value="0" />
        </xpath>
        <xpath expr="//span[@t-field='move.product_id']//.." position="before">
            <td name="td_sm_item_count">
                <t t-set="current_item" t-value="current_item + 1" />
                <span t-esc="current_item" />
            </td>
        </xpath>
    </template>

    <!-- PICKING OPERATIONS -->
    <template
        id="report_picking_item_count"
        inherit_id="stock.report_picking"
        priority="10"
    >
        <xpath expr="//th[@name='th_product']" position="before">
            <th name="th_item_count">
                <strong>Item</strong>
            </th>
        </xpath>
        <xpath expr="//t[@t-as='move']" position="before">
            <t t-set="current_item" t-value="0" />
        </xpath>
        <xpath
            expr="//span[@t-field='ml.product_id.display_name']//.."
            position="before"
        >
            <td name="td_item_count">
                <t t-set="current_item" t-value="current_item + 1" />
                <span t-esc="current_item" />
            </td>
        </xpath>
    </template>
</odoo>
